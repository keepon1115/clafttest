<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>冒険者ダッシュボード - ホーム</title>
    
    <!-- キャッシュ制御 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- PWA関連メタタグ -->
    <meta name="theme-color" content="#29B6F6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CLAFT">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="manifest" href="manifest.json">
    
    <!-- フォントとスタイル -->
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;500;700;900&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="css/navigation.css">
    <link rel="stylesheet" href="css/auth.css">
    
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/auth.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --blue: #29B6F6;
            --yellow: #F6CF3F;
            --pink: #FF5FA0;
            --purple: #7E57C2;
            --green: #4CAF50;
            --orange: #FF9800;
            --gray: #F5F5F5;
            --text-dark: #333;
            --shadow: rgba(0, 0, 0, 0.1) 0 4px 20px;
            --shadow-hover: rgba(0, 0, 0, 0.15) 0 8px 30px;
            --sidebar-bg: #3A3F45;
            --sidebar-active: #4A4E54;
            --cream-bg: #FFFCEB;
            --gold: #FFD700;
            --silver: #C0C0C0;
            --bronze: #CD7F32;
            --cyan: #00BCD4;
            --teal: #009688;
        }

        body {
            font-family: 'M PLUS Rounded 1c', 'Noto Sans JP', sans-serif;
            background-color: var(--cream-bg);
            color: var(--text-dark);
            overflow-x: hidden;
            position: relative;
        }

        /* 背景アニメーション */
        .background-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            overflow: hidden;
        }

        .parallax-layer {
            position: absolute;
            width: 110%;
            height: 100%;
            top: 0;
            left: -5%;
        }

        .sky-layer {
            background: linear-gradient(to bottom, #87CEEB 0%, #98D8E8 50%, var(--cream-bg) 100%);
            z-index: 1;
        }

        .clouds {
            z-index: 2;
        }

        .cloud {
            position: absolute;
            background: white;
            border-radius: 100px;
            opacity: 0.8;
        }

        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: white;
            border-radius: 100px;
        }

        .cloud1 {
            width: 100px;
            height: 40px;
            top: 20%;
            animation: drift 45s infinite linear; /* linearを追加 */
        }

        .cloud1::before {
            width: 50px;
            height: 50px;
            top: -25px;
            left: 10px;
        }

        .cloud1::after {
            width: 60px;
            height: 40px;
            top: -15px;
            right: 10px;
        }

        .cloud2 {
            width: 80px;
            height: 35px;
            top: 40%;
            animation: drift 60s infinite linear; /* linearを追加 */
            animation-delay: -20s;
        }

        .cloud2::before {
            width: 60px;
            height: 45px;
            top: -20px;
            left: 15px;
        }

        .cloud3 {
            width: 120px;
            height: 45px;
            top: 60%;
            animation: drift 50s infinite linear; /* linearを追加 */
            animation-delay: -35s;
        }

        .cloud3::before {
            width: 70px;
            height: 55px;
            top: -25px;
            right: 20px;
        }

        @keyframes drift {
            from { transform: translateX(-200px); }
            to { transform: translateX(calc(100vw + 200px)); }
        }

        .city-silhouette {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 200"><path fill="%23000000" opacity="0.1" d="M0,200 L0,160 L50,160 L50,100 L100,100 L100,140 L150,140 L150,80 L200,80 L200,120 L300,120 L300,60 L350,60 L350,100 L400,100 L400,140 L500,140 L500,40 L550,40 L550,90 L600,90 L600,130 L700,130 L700,70 L750,70 L750,110 L800,110 L800,150 L900,150 L900,50 L950,50 L950,100 L1000,100 L1000,140 L1100,140 L1100,80 L1150,80 L1150,120 L1200,120 L1200,200 Z"/></svg>') repeat-x;
            background-size: 1200px 200px;
            z-index: 3;
        }



        /* 改良されたヘッダー */
        .header {
            background: linear-gradient(135deg, var(--blue) 0%, var(--purple) 100%);
            color: white;
            padding: 15px 30px 15px 70px; /* 左側にハンバーガーメニュー用のスペースを確保 */
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 90; /* ハンバーガーメニューより低く維持 */
            overflow: hidden;
        }

        /* ハンバーガーメニューの表示を確実にする */
        .hamburger-menu {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: rotate-bg 30s linear infinite; /* アニメーション名変更 */
        }

        @keyframes rotate-bg { /* アニメーション名変更 */
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .greeting-section h1 {
            font-size: 28px;
            font-weight: 900;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .greeting-section p {
            font-size: 16px;
            opacity: 0.9;
        }

        .achievements {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .achievement-badge {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .achievement-badge:hover {
            transform: translateY(-3px) scale(1.1);
        }

        .achievement-badge.gold {
            background: linear-gradient(135deg, var(--gold), #FFE55C);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
        }

        .achievement-badge.silver {
            background: linear-gradient(135deg, var(--silver), #E0E0E0);
            box-shadow: 0 4px 15px rgba(192, 192, 192, 0.4);
        }

        .achievement-badge.bronze {
            background: linear-gradient(135deg, var(--bronze), #E4A676);
            box-shadow: 0 4px 15px rgba(205, 127, 50, 0.4);
        }

        .achievement-badge .tooltip {
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-dark);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .achievement-badge:hover .tooltip {
            opacity: 1;
            visibility: visible;
            bottom: -40px;
        }

        .exp-bar-container {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: rgba(0, 0, 0, 0.1);
        }

        .exp-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--yellow) 0%, var(--gold) 100%);
            width: 65%;
            position: relative;
            overflow: hidden;
            transition: width 0.5s ease;
        }

        .exp-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.4) 50%, transparent 100%);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            from { transform: translateX(-100%); }
            to { transform: translateX(100%); }
        }

        /* メインコンテンツ - 改良版 */
        .main-content {
            padding: 20px;
            padding-top: 20px;
            display: flex;
            gap: 40px;
            align-items: stretch; /* 左右のカードの高さを揃える */
            position: relative;
            z-index: 10;
            margin-left: 0; /* サイドバー非表示時のマージン */
            transition: margin-left 0.3s ease;
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 15px;
                padding-top: 15px;
                flex-direction: column;
            }
        }



        /* プロフィールカード - 画面の50%に拡張 */
        .profile-card {
            flex: 0 0 calc(50% - 20px); /* gapの半分を引く */
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .profile-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
        }

        .profile-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--purple) 0%, transparent 70%);
            opacity: 0.05;
            animation: rotate-bg 20s linear infinite; /* アニメーション名変更 */
        }

        /* プロフィール基本情報エリア */
        .profile-header {
            text-align: center;
            padding: 35px 35px 25px;
            position: relative;
            background: linear-gradient(180deg, rgba(126, 87, 194, 0.1) 0%, transparent 100%);
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            margin: 0 auto 20px;
            position: relative;
            animation: float-avatar 4s ease-in-out infinite; /* アニメーション名変更 */
        }

        @keyframes float-avatar { /* アニメーション名変更 */
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .avatar-container {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: white;
            box-shadow: 0 8px 30px rgba(126, 87, 194, 0.4);
            position: relative;
            overflow: hidden;
        }

        .avatar-container::after {
            content: '';
            position: absolute;
            top: 10%;
            right: 10%;
            width: 30%;
            height: 30%;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            filter: blur(10px);
        }

        .avatar-container i {
            z-index: 1;
            animation: breathe-icon 3s ease-in-out infinite; /* アニメーション名変更 */
        }

        @keyframes breathe-icon { /* アニメーション名変更 */
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .status-indicator {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 25px;
            height: 25px;
            background: var(--green);
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(76, 175, 80, 0.4);
            animation: pulse-indicator 2s ease infinite; /* アニメーション名変更 */
        }
         @keyframes pulse-indicator { /* アニメーション名変更 */
            0%, 100% { transform: scale(1); box-shadow: 0 2px 10px rgba(76, 175, 80, 0.4); }
            50% { transform: scale(1.1); box-shadow: 0 4px 15px rgba(76, 175, 80, 0.6); }
        }


        .profile-name {
            font-size: 28px;
            font-weight: 900;
            color: var(--text-dark);
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .profile-character {
            color: var(--purple);
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .profile-character::before,
        .profile-character::after {
            content: '✨';
            font-size: 14px;
            animation: twinkle-emoji 2s ease infinite; /* アニメーション名変更 */
        }

        @keyframes twinkle-emoji { /* アニメーション名変更 */
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .profile-catchphrase {
            background: linear-gradient(135deg, var(--yellow) 0%, var(--gold) 100%);
            color: var(--text-dark);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 15px;
            font-weight: 700;
            margin-top: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(246, 207, 63, 0.3);
            animation: glow-catchphrase 3s ease infinite alternate; /* アニメーション名変更, alternate追加 */
            display: inline-block;
        }

        @keyframes glow-catchphrase { /* アニメーション名変更 */
            0% { box-shadow: 0 4px 15px rgba(246, 207, 63, 0.3); }
            100% { box-shadow: 0 4px 25px rgba(246, 207, 63, 0.5), 0 0 10px var(--gold); }
        }


        .profile-catchphrase::before {
            content: '💭';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
        }

        .profile-catchphrase-text {
            margin-left: 25px;
        }

        /* プロフィール詳細情報エリア */
        .profile-details {
            padding: 0 35px 35px;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* 能力・特性エリア */
        .profile-abilities {
            display: flex;
            gap: 20px;
        }

        .ability-card {
            flex: 1;
            background: white;
            border-radius: 18px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .ability-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, rgba(41, 182, 246, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .ability-card:hover::before {
            opacity: 1;
        }

        .ability-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .ability-card.strength {
            border-top: 4px solid var(--green);
        }

        .ability-card.weakness {
            border-top: 4px solid var(--pink);
        }

        .ability-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .ability-icon {
            width: 36px;
            height: 36px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .ability-card.strength .ability-icon {
            background: rgba(76, 175, 80, 0.2);
            color: var(--green);
        }

        .ability-card.weakness .ability-icon {
            background: rgba(255, 95, 160, 0.2);
            color: var(--pink);
        }

        .ability-title {
            font-size: 15px;
            font-weight: 700;
            color: #666;
        }

        .ability-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .ability-tag {
            background: var(--gray);
            color: var(--text-dark);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .ability-card.strength .ability-tag:hover {
            background: var(--green);
            color: white;
            transform: translateY(-2px);
        }

        .ability-card.weakness .ability-tag:hover {
            background: var(--pink);
            color: white;
            transform: translateY(-2px);
        }

        /* パーソナル情報エリア */
        .profile-personal {
            background: linear-gradient(145deg, #f8f8f8, #ffffff);
            border-radius: 18px;
            padding: 20px;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .personal-item {
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .personal-item:last-child {
            border-bottom: none;
        }

        .personal-item:hover {
            padding-left: 10px;
        }

        .personal-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: #666;
            margin-bottom: 6px;
        }

        .personal-value {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-dark);
            line-height: 1.5;
        }

        /* 一緒に冒険したい人 */
        .adventure-partner {
            background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%);
            color: white;
            border-radius: 18px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(126, 87, 194, 0.3);
        }

        .adventure-partner::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
            animation: rotate-bg 15s linear infinite; /* アニメーション名変更 */
        }

        .adventure-partner-content {
            position: relative;
            z-index: 1;
        }

        .adventure-partner-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            margin-bottom: 8px;
            opacity: 0.9;
        }

        .adventure-partner-value {
            font-size: 16px;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        /* ひとことエリア */
        .profile-comment {
            background: white;
            border-radius: 18px;
            padding: 20px;
            border: 2px solid var(--gray);
            position: relative;
            transition: all 0.3s ease;
        }

        .profile-comment:hover {
            border-color: var(--blue);
            box-shadow: 0 4px 15px rgba(41, 182, 246, 0.1);
        }

        .comment-header {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }

        .comment-text {
            font-size: 15px;
            line-height: 1.6;
            color: var(--text-dark);
        }

        /* 編集ボタン */
        .edit-profile-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--blue) 0%, var(--purple) 100%);
            color: white;
            border: none;
            border-radius: 18px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin-top: auto; /* 親がflex-direction: column の場合に下寄せ */
        }

        .edit-profile-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.5s ease;
        }

        .edit-profile-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .edit-profile-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(41, 182, 246, 0.3);
        }

        /* 右側のコンテンツエリア */
        .content-area {
            flex: 0 0 calc(50% - 20px); /* gapの半分を引く */
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        /* クラフトストーリーカード */
        .craft-story-card {
            background: white;
            border-radius: 20px;
            padding: 35px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .craft-story-card::before {
            content: '';
            position: absolute;
            top: -100px;
            right: -100px;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, var(--yellow) 0%, transparent 70%);
            opacity: 0.1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .card-title {
            font-size: 26px;
            font-weight: 700;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-title i {
            color: var(--purple);
        }

        /* 目標セクション */
        .goals-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .goal-card {
            background: linear-gradient(145deg, #f8f8f8, #ffffff);
            border-radius: 16px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .goal-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--orange) 0%, var(--pink) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1;
        }

        .goal-card:hover::before {
            opacity: 0.1;
        }

        .goal-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: var(--orange);
        }

        .goal-content {
            position: relative;
            z-index: 2;
        }

        .goal-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--orange) 0%, var(--pink) 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
            transition: all 0.3s ease;
        }

        .goal-card:hover .goal-icon {
            transform: rotate(10deg) scale(1.1);
        }

        .goal-label {
            font-size: 14px;
            color: #666;
            font-weight: 500;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .goal-label::after {
            content: '🎯'; /* アイコンはCSSで指定 */
            font-size: 16px;
        }

        .goal-text {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-dark);
            line-height: 1.4;
        }

        .goal-progress {
            margin-top: 12px;
            background: rgba(0, 0, 0, 0.05);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
        }

        .goal-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--orange) 0%, var(--pink) 100%);
            width: 60%; /* デフォルト値、HTML側で上書き可能 */
            transition: width 0.3s ease;
        }

        /* アクションセクション */
        .actions-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .action-link {
            background: linear-gradient(135deg, var(--cyan) 0%, var(--teal) 100%);
            color: white;
            border: none;
            border-radius: 16px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 188, 212, 0.3);
        }

        .action-link::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
            transform: rotate(0deg);
            transition: transform 0.5s ease;
        }

        .action-link:hover::before {
            transform: rotate(90deg);
        }

        .action-link:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 188, 212, 0.4);
        }

        .action-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .action-link:hover .action-icon {
            transform: rotate(360deg);
            background: rgba(255, 255, 255, 0.3);
        }

        .action-content {
            position: relative;
            z-index: 1;
            flex: 1;
        }

        .action-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .action-desc {
            font-size: 14px;
            opacity: 0.9;
        }

        .action-arrow {
            position: relative;
            z-index: 1;
            font-size: 20px;
            transition: all 0.3s ease;
        }

        .action-link:hover .action-arrow {
            transform: translateX(5px);
        }

        /* ジブンクラフトカード */
        .jibun-craft-card {
            background: white;
            border-radius: 20px;
            padding: 35px;
            box-shadow: var(--shadow);
            position: relative;
            flex: 1; /* 残りの高さを埋める */
            display: flex;
            flex-direction: column;
        }
         .jibun-craft-card .card-title i { /* ジブンクラフトカードのアイコン色 */
            color: var(--green);
        }


        /* 5つの力メーター */
        .powers-section {
            margin-bottom: 30px;
        }

        .power-meter {
            margin-bottom: 20px;
        }
        .power-meter:last-child {
            margin-bottom: 0;
        }

        .power-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .power-name {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .power-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px; /* アイコンサイズ調整 */
        }

        .power-icon.tsunagu {
            background: rgba(41, 182, 246, 0.2);
            color: var(--blue);
        }

        .power-icon.hiraku {
            background: rgba(126, 87, 194, 0.2);
            color: var(--purple);
        }

        .power-icon.egaku {
            background: rgba(255, 152, 0, 0.2);
            color: var(--orange);
        }

        .power-icon.narikiru {
            background: rgba(255, 95, 160, 0.2);
            color: var(--pink);
        }

        .power-icon.makikomu {
            background: rgba(76, 175, 80, 0.2);
            color: var(--green);
        }

        .power-level {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .power-bar-container {
            background: #E0E0E0;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }

        .power-bar {
            height: 100%;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
            transition: width 0.5s ease;
        }

        .power-bar.tsunagu {
            background: linear-gradient(90deg, var(--blue) 0%, #03A9F4 100%);
            /* width: 40%; HTML側で指定 */
        }

        .power-bar.hiraku {
            background: linear-gradient(90deg, var(--purple) 0%, #5E35B1 100%);
            /* width: 60%; HTML側で指定 */
        }

        .power-bar.egaku {
            background: linear-gradient(90deg, var(--orange) 0%, #FB8C00 100%);
            /* width: 60%; HTML側で指定 */
        }

        .power-bar.narikiru {
            background: linear-gradient(90deg, var(--pink) 0%, #F06292 100%);
            /* width: 40%; HTML側で指定 */
        }

        .power-bar.makikomu {
            background: linear-gradient(90deg, var(--green) 0%, #43A047 100%);
            /* width: 40%; HTML側で指定 */
        }

        .power-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.3) 50%, transparent 100%);
            animation: shimmer 2s infinite;
        }

        /* スキルタブセクション */
        .skills-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-top: 20px; /* powers-sectionとの間にマージン */
        }

        .skills-tabs {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .skill-tab {
            background: linear-gradient(145deg, #f5f5f5, #e0e0e0);
            border: 2px solid transparent;
            border-radius: 16px;
            padding: 20px 10px; /* パディング調整 */
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
            display: flex; /* アイコンとラベルを中央揃え */
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .skill-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--blue) 0%, var(--purple) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }

        .skill-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--blue);
        }

        .skill-tab.active {
            border-color: var(--blue);
            color: white;
        }

        .skill-tab.active::before {
            opacity: 1;
        }
        .skill-tab.active i, .skill-tab.active .skill-tab-label {
            color: white;
        }


        .skill-tab.locked {
            opacity: 0.6;
            cursor: not-allowed;
            background: #E0E0E0;
        }
        .skill-tab.locked i, .skill-tab.locked .skill-tab-label {
            color: #999;
        }

        .skill-tab.locked:hover {
            transform: none;
            box-shadow: none;
            border-color: transparent;
        }
        .skill-tab.locked:hover::before {
            opacity: 0;
        }


        .skill-tab-content {
            position: relative;
            z-index: 1;
        }

        .skill-tab i {
            font-size: 28px; /* アイコンサイズ調整 */
            margin-bottom: 10px; /* マージン調整 */
            display: block;
            transition: all 0.3s ease;
            color: var(--purple); /* デフォルトアイコン色 */
        }
        .skill-tab.active i { color: white; } /* アクティブ時のアイコン色 */
        .skill-tab.locked i { color: #777; } /* ロック時のアイコン色 */


        .skill-tab:hover i:not(.fa-lock) {
            transform: rotate(10deg) scale(1.1);
        }

        .skill-tab-label {
            font-size: 14px; /* ラベルサイズ調整 */
            font-weight: 600;
            color: var(--text-dark); /* デフォルトラベル色 */
        }
        .skill-tab.active .skill-tab-label { color: white; } /* アクティブ時のラベル色 */
        .skill-tab.locked .skill-tab-label { color: #777; } /* ロック時のラベル色 */


        .skill-tab-level {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--green);
            color: white;
            padding: 3px 8px; /* パディング調整 */
            border-radius: 12px;
            font-size: 11px; /* フォントサイズ調整 */
            font-weight: 700;
            z-index: 2;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }

        .skill-tab.locked .skill-tab-level {
            background: #999;
            box-shadow: none;
        }

        /* レベルアップモーダル */
        .levelup-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001; /* hamburger menuと同等かそれ以上 */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .levelup-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .levelup-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            position: relative;
            transform: scale(0.8) translateY(20px);
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
            max-width: 500px;
            width: 90%;
        }

        .levelup-modal.active .levelup-content {
            transform: scale(1) translateY(0);
            opacity: 1;
        }

        .levelup-icon {
            font-size: 80px;
            color: var(--gold);
            margin-bottom: 20px;
            animation: bounce-levelup-icon 0.8s ease; /* アニメーション名変更 */
        }
        @keyframes bounce-levelup-icon { /* アニメーション名変更 */
            0% { transform: scale(0.5); opacity: 0; }
            60% { transform: scale(1.2); opacity: 1; }
            80% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        .levelup-title {
            font-size: 32px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .levelup-message {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
        }

        .levelup-rewards {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .reward-item {
            background: var(--gray);
            border-radius: 10px;
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .reward-icon {
            font-size: 24px;
            color: var(--purple);
        }

        .reward-text {
            font-size: 16px;
            font-weight: 500;
        }

        .levelup-close {
            background: linear-gradient(135deg, var(--blue) 0%, var(--purple) 100%);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .levelup-close:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(41, 182, 246, 0.3);
        }

        /* 通知システム */
        .notification-container {
            position: fixed;
            top: 80px; /* ヘッダーとかぶらないように調整 */
            right: 20px;
            z-index: 1005; /* モーダルより手前など、必要に応じて調整 */
            width: 320px;
        }

        .notification {
            background: white;
            border-radius: 15px;
            padding: 15px 20px;
            margin-bottom: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            transform: translateX(120%); /* 初期位置を画面外右へ */
            opacity: 0;
            transition: transform 0.4s ease, opacity 0.4s ease;
            animation: slideInNotification 0.4s ease forwards; /* アニメーション名変更 */
        }
        .notification.show { /* JSで付与するクラス */
            transform: translateX(0);
            opacity: 1;
        }
        .notification.hide { /* JSで付与するクラス */
            transform: translateX(120%);
            opacity: 0;
        }


        @keyframes slideInNotification { /* アニメーション名変更 */
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOutNotification { /* アニメーション名変更 */
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(120%); opacity: 0; }
        }


        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            flex-shrink: 0;
        }

        .notification-icon.success {
            background: var(--green);
        }

        .notification-icon.info {
            background: var(--blue);
        }

        .notification-icon.achievement {
            background: var(--gold);
        }
         .notification-icon.error { /* エラータイプ追加 */
            background: var(--pink);
        }

        .notification-content h4 {
            font-size: 16px;
            margin-bottom: 2px;
            font-weight: 700;
        }

        .notification-content p {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
        }

        /* レスポンシブ対応 */
        @media (max-width: 1400px) {
            .main-content {
                padding: 30px;
            }
        }

        @media (max-width: 1200px) {
            .main-content {
                flex-direction: column;
                align-items: stretch; /* 引き続き高さを揃える */
            }
            
            .profile-card,
            .content-area {
                flex: 1 1 auto; /* flex-basisをautoに */
                width: 100%; /* 幅を100%に */
            }
             .profile-card {
                margin-bottom: 30px; /* カード間のマージン */
            }
        }

        @media (max-width: 768px) {
            .hamburger-menu {
                top: 15px;
                left: 15px;
            }
            
            .header {
                padding: 15px 20px 15px 60px; /* ハンバーガー分左パディング */
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
             .achievements { /* スマホ表示でアチーブメントを中央揃え */
                justify-content: center;
            }
            
            .greeting-section h1 {
                font-size: 24px;
            }
            
            .greeting-section p {
                font-size: 14px;
            }
            
            .achievements {
                flex-wrap: wrap;
            }
            
            .main-content {
                padding: 15px;
                padding-top: 15px;
                flex-direction: column;
            }
            
            .goals-section,
            .actions-section {
                grid-template-columns: 1fr; /* 1列表示 */
            }
            
            .skills-tabs {
                grid-template-columns: repeat(2, 1fr); /* 2列表示 */
            }
            .profile-abilities {
                flex-direction: column;
            }
             .notification-container {
                width: calc(100% - 40px);
                top: 70px;
                left: 20px;
                right: 20px;
            }
        }
        @media (max-width: 480px) {
            .skills-tabs {
                grid-template-columns: 1fr; /* スマホ縦では1列表示 */
            }
            .greeting-section h1 {
                font-size: 20px;
            }
            .card-title {
                font-size: 22px;
            }
             .levelup-content {
                padding: 30px 20px;
            }
            .levelup-title {
                font-size: 26px;
            }
            .levelup-message {
                font-size: 16px;
            }

        }

        /* アニメーション (重複定義を避けるため、必要なものだけ残す) */
        /* @keyframes slideOut は notification.hide で実現 */
        
        @keyframes confettifall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            top: -10px; /* 初期位置を画面上部外に */
            z-index: 1002; /* モーダルより手前、通知よりは奥など */
            animation: confettifall 3s linear forwards;
            pointer-events: none; /* クリックイベントを透過 */
        }

        /* 認証状態表示スタイル */
        .auth-status {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .auth-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .login-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .login-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .logout-btn {
            background: rgba(220, 53, 69, 0.8);
            color: white;
        }

        .logout-btn:hover {
            background: rgba(220, 53, 69, 1);
            transform: translateY(-2px);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-details {
            text-align: right;
        }

    <!-- サイドバー -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">🎮 CLAFT</div>
        </div>
        <div class="sidebar-nav">
            <ul>
                <li><a href="index.html" class="active"><i class="fas fa-home"></i><span class="nav-label">ホーム</span></a></li>
                <li><a href="quest.html"><i class="fas fa-map"></i><span class="nav-label">クエストマップ</span></a></li>
                <li><a href="yononaka.html"><i class="fas fa-globe"></i><span class="nav-label">Yononaka</span></a></li>
                <li><a href="mirai.html"><i class="fas fa-rocket"></i><span class="nav-label">ミライクラフト</span></a></li>
            </ul>
        </div>
    </nav>

    <!-- オーバーレイ -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- 認証ボタン用スペース -->
    <div class="nav-buttons"></div>

    <!-- 背景 -->
    <div class="background-wrapper">
        <div class="parallax-layer sky-layer"></div>
        <div class="parallax-layer clouds">
            <div class="cloud cloud1"></div>
            <div class="cloud cloud2"></div>
            <div class="cloud cloud3"></div>
        </div>
        <div class="city-silhouette"></div>
    </div>

    <!-- ヘッダー -->
    <header class="header">
        <div class="header-content">
            <div class="player-info">
                <div class="greeting-section">
                    <h1 id="greeting">こんにちは、<span id="playerName">たろう</span>さん！</h1>
                    <p id="subGreeting">今日も素晴らしい冒険を始めましょう</p>
                </div>
            </div>
            <div class="auth-status">
                <!-- ログイン前 -->
                <button data-auth-action="login" class="auth-btn login-btn" style="display: none;">
                    <i class="fas fa-sign-in-alt"></i> ログイン/登録
                </button>
                
                <!-- ログイン後 -->
                <div class="user-info" id="userInfo" style="display: none;">
                    <div class="user-details">
                        <span class="user-name" id="headerUserName">ユーザー名</span>
                        <div class="user-stats">
                            <span class="stat-item">
                                <i class="fas fa-calendar-check"></i>
                                <span id="loginCount">0</span>回ログイン
                            </span>
                            <span class="stat-item">
                                <i class="fas fa-trophy"></i>
                                <span id="questClearCount">0</span>クエストクリア
                            </span>
                </div>
                </div>
                    <button data-auth-action="logout" class="auth-btn logout-btn">
                        <i class="fas fa-sign-out-alt"></i> ログアウト
                    </button>
                </div>
            </div>
        </div>
        <div class="exp-bar-container">
            <div class="exp-bar" id="expBar" style="width: 65%;"></div> <!-- styleで初期幅指定 -->
        </div>
    </header>

    <!-- メインコンテンツ -->
    <main class="main-content">
        <!-- プロフィールカード（画面の50%） -->
        <div class="profile-card">
            <!-- 基本情報エリア -->
            <div class="profile-header">
                <div class="profile-avatar">
                    <div class="avatar-container">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="status-indicator"></div>
                </div>
                <h2 class="profile-name" id="profileName">たろう</h2>
                <p class="profile-character" id="profileCharacter">
                    <span id="characterText">冒険大好き！挑戦者タイプ</span>
                </p>
                <div class="profile-catchphrase" id="profileCatchphrase">
                    <span class="profile-catchphrase-text" id="catchphraseText">「新しいことにチャレンジだ！」</span>
                </div>
            </div>

            <!-- 詳細情報エリア -->
            <div class="profile-details">
                <!-- 能力・特性 -->
                <div class="profile-abilities">
                    <div class="ability-card strength">
                        <div class="ability-header">
                            <div class="ability-icon">💪</div>
                            <div class="ability-title">とくい</div>
                        </div>
                        <div class="ability-tags" id="strengthTags">
                            <span class="ability-tag">プログラミング</span>
                            <span class="ability-tag">デザイン</span>
                            <span class="ability-tag">問題解決</span>
                        </div>
                    </div>
                    <div class="ability-card weakness">
                        <div class="ability-header">
                            <div class="ability-icon">😅</div>
                            <div class="ability-title">よわみ</div>
                        </div>
                        <div class="ability-tags" id="weaknessTags">
                            <span class="ability-tag">時間管理</span>
                            <span class="ability-tag">朝起き</span>
                        </div>
                    </div>
                </div>

                <!-- パーソナル情報 -->
                <div class="profile-personal">
                    <div class="personal-item">
                        <div class="personal-label">
                            <span>🏖️</span>
                            <span>すきな時間・場所</span>
                        </div>
                        <div class="personal-value" id="favoriteTime">
                            カフェでコーヒーを飲みながらコーディング
                        </div>
                    </div>
                    <div class="personal-item">
                        <div class="personal-label">
                            <span>⚡</span>
                            <span>エネルギーチャージ方法</span>
                        </div>
                        <div class="personal-value" id="energyCharge">
                            音楽を聴きながら散歩する
                        </div>
                    </div>
                </div>

                <!-- 一緒に冒険したい人 -->
                <div class="adventure-partner">
                    <div class="adventure-partner-content">
                        <div class="adventure-partner-label">
                            <span>🤝</span>
                            <span>一緒に冒険したい人</span>
                        </div>
                        <div class="adventure-partner-value" id="adventurePartner">
                            新しいアイデアをシェアできるクリエイティブな仲間
                        </div>
                    </div>
                </div>

                <!-- ひとこと -->
                <div class="profile-comment">
                    <div class="comment-header">
                        <span>📝</span>
                        <span>ひとこと</span>
                    </div>
                    <div class="comment-text" id="commentText">
                        毎日が新しい冒険！プログラミングを通じて、世界をもっと便利で楽しい場所にしたいです。一緒に素晴らしいものを作りましょう！
                    </div>
                </div>

                <!-- 編集ボタン -->
                <button class="edit-profile-btn" onclick="goToProfileEdit()">
                    <i class="fas fa-pencil-alt"></i> プロフィール編集
                </button>
            </div>
        </div>

        <!-- コンテンツエリア（画面の50%） -->
        <div class="content-area">
            <!-- クラフトストーリーカード -->
            <div class="craft-story-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-book-open"></i>
                        クラフトストーリー
                    </h3>
                </div>
                
                <!-- 目標セクション -->
                <div class="goals-section">
                    <div class="goal-card">
                        <div class="goal-content">
                            <div class="goal-icon">
                                <i class="fas fa-flag-checkered"></i> <!-- 短期目標アイコン -->
                            </div>
                            <div class="goal-label">短期目標</div>
                            <div class="goal-text">夏休み中に「学校の不便を解決するミニサービス」を3つ考えてメモする</div>
                            <div class="goal-progress">
                                <div class="goal-progress-bar" style="width: 75%;"></div> <!-- 進捗例 -->
                            </div>
                        </div>
                    </div>
                    <div class="goal-card">
                        <div class="goal-content">
                            <div class="goal-icon">
                                <i class="fas fa-mountain"></i> <!-- 長期目標アイコン -->
                            </div>
                            <div class="goal-label">長期目標</div>
                            <div class="goal-text">アイデアコンテストで優勝する</div>
                            <div class="goal-progress">
                                <div class="goal-progress-bar" style="width: 30%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- アクションセクション -->
                <div class="actions-section">
                    <a href="#created" class="action-link">
                        <div class="action-icon">
                            <i class="fas fa-palette"></i>
                        </div>
                        <div class="action-content">
                            <div class="action-title">つくったもの</div>
                            <div class="action-desc">作品ギャラリーを見る</div>
                        </div>
                        <div class="action-arrow">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </a>
                    <a href="#talked" class="action-link">
                        <div class="action-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <div class="action-content">
                            <div class="action-title">はなしたこと</div>
                            <div class="action-desc">会話の記録を見る</div>
                        </div>
                        <div class="action-arrow">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </a>
                </div>
            </div> <!-- .craft-story-card 終了 -->

            <!-- ジブンクラフトカード (新規追加) -->
            <div class="jibun-craft-card" id="jibun-craft-card-anchor"> <!-- id追加 -->
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-cogs"></i> <!-- ジブンクラフト アイコン例 -->
                        ジブンクラフト
                    </h3>
                </div>

                <!-- 5つの力メーター -->
                <div class="powers-section">
                    <div class="power-meter">
                        <div class="power-header">
                            <span class="power-name">
                                <span class="power-icon tsunagu"><i class="fas fa-link"></i></span>
                                つなぐ力
                            </span>
                            <span class="power-level">Lv. 4</span>
                        </div>
                        <div class="power-bar-container">
                            <div class="power-bar tsunagu" style="width: 40%;"></div>
                        </div>
                    </div>
                    <div class="power-meter">
                        <div class="power-header">
                            <span class="power-name">
                                <span class="power-icon hiraku"><i class="fas fa-lightbulb"></i></span>
                                ひらく力
                            </span>
                            <span class="power-level">Lv. 6</span>
                        </div>
                        <div class="power-bar-container">
                            <div class="power-bar hiraku" style="width: 60%;"></div>
                        </div>
                    </div>
                    <div class="power-meter">
                        <div class="power-header">
                            <span class="power-name">
                                <span class="power-icon egaku"><i class="fas fa-pencil-ruler"></i></span>
                                えがく力
                            </span>
                            <span class="power-level">Lv. 6</span>
                        </div>
                        <div class="power-bar-container">
                            <div class="power-bar egaku" style="width: 60%;"></div>
                        </div>
                    </div>
                    <div class="power-meter">
                        <div class="power-header">
                            <span class="power-name">
                                <span class="power-icon narikiru"><i class="fas fa-theater-masks"></i></span>
                                なりきる力
                            </span>
                            <span class="power-level">Lv. 4</span>
                        </div>
                        <div class="power-bar-container">
                            <div class="power-bar narikiru" style="width: 40%;"></div>
                        </div>
                    </div>
                    <div class="power-meter">
                        <div class="power-header">
                            <span class="power-name">
                                <span class="power-icon makikomu"><i class="fas fa-users"></i></span>
                                まきこむ力
                            </span>
                            <span class="power-level">Lv. 4</span>
                        </div>
                        <div class="power-bar-container">
                            <div class="power-bar makikomu" style="width: 40%;"></div>
                        </div>
                    </div>
                </div>

                <!-- スキルタブ -->
                <div class="skills-section">
                    <div class="skills-tabs">
                        <div class="skill-tab active"> <!-- 初期アクティブ例 -->
                            <div class="skill-tab-content">
                                <i class="fas fa-yen-sign"></i>
                                <div class="skill-tab-label">お金</div>
                            </div>
                            <span class="skill-tab-level">Lv.5</span>
                        </div>
                        <div class="skill-tab">
                             <div class="skill-tab-content">
                                <i class="fas fa-laptop-code"></i>
                                <div class="skill-tab-label">技術</div>
                            </div>
                            <span class="skill-tab-level">Lv.3</span>
                        </div>
                        <div class="skill-tab">
                            <div class="skill-tab-content">
                                <i class="fas fa-comments"></i>
                                <div class="skill-tab-label">対話力</div>
                            </div>
                             <span class="skill-tab-level">Lv.4</span>
                        </div>
                        <div class="skill-tab locked">
                            <div class="skill-tab-content">
                                <i class="fas fa-lock"></i>
                                <div class="skill-tab-label">？？？</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- .jibun-craft-card 終了 -->
        </div> <!-- .content-area 終了 -->
    </main> <!-- .main-content 終了 -->

    <!-- レベルアップモーダル -->
    <div class="levelup-modal" id="levelUpModal">
        <div class="levelup-content">
            <div class="levelup-icon">🎉</div>
            <h3 class="levelup-title">レベルアップ！</h3>
            <p class="levelup-message">新しいスキルと報酬を獲得しました！</p>
            <div class="levelup-rewards">
                <div class="reward-item">
                    <span class="reward-icon"><i class="fas fa-star"></i></span>
                    <span class="reward-text">+100 EXP</span>
                </div>
                <div class="reward-item">
                    <span class="reward-icon"><i class="fas fa-gem"></i></span>
                    <span class="reward-text">新しいバッジ</span>
                </div>
            </div>
            <button class="levelup-close" onclick="closeLevelUpModal()">閉じる</button>
        </div>
    </div>

    <!-- 通知コンテナ -->
    <div class="notification-container" id="notificationContainer">
        <!-- 通知はJavaScriptで動的に追加されます -->
    </div>

<!-- include.js はすぐ読み込む -->
<script src="js/include.js"></script>

<!-- Supabaseが読み込まれてからauth.jsを読み込む -->
<script>
function loadAuthWhenReady() {
    if (window.supabase && window.supabase.createClient) {
        const script = document.createElement('script');
        script.src = 'js/auth.js';
        document.body.appendChild(script);
            } else {
        setTimeout(loadAuthWhenReady, 100);
    }
}
loadAuthWhenReady();
    </script>
    
<!-- ページ読み込み時の初期化 -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
    if (window.authManager && authManager.getCurrentUser()) {
        document.getElementById('welcomeMessage').textContent = `ようこそ、${authManager.getCurrentUser().email}さん！`;
        } else {
        document.getElementById('welcomeMessage').textContent = 'ようこそ、冒険者さん！';
        }
    });
    </script>

</body>
</html>
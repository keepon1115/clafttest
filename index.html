<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLAFT - ã‚¯ã‚¨ã‚¹ãƒˆãƒãƒƒãƒ—</title>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;900&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #4DB6F7;
            --accent-green: #8EE38F;
            --bg-warm-white: #FFFEF5;
            --text-dark: #2C3E50;
            --text-light: #6B7280;
            --shadow-soft: rgba(0, 0, 0, 0.08);
            --cta-red: #FF6B6B;
            --disabled-gray: #D1D5DB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(180deg, #E0F2FE 0%, #FEF3C7 100%);
            color: var(--text-dark);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .heading-primary { 
            font-family: 'M PLUS Rounded 1c', sans-serif; 
            font-weight: 900;
        }
        
        .heading-secondary { 
            font-family: 'M PLUS Rounded 1c', sans-serif; 
            font-weight: 700;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .map-header {
            background: white;
            padding: 20px;
            box-shadow: 0 2px 8px var(--shadow-soft);
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .home-btn {
            width: 44px;
            height: 44px;
            border: none;
            background: var(--primary-blue);
            color: white;
            border-radius: 12px;
            cursor: pointer;
            font-size: 20px;
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .home-btn:hover {
            transform: scale(1.1);
        }

        .map-title {
            font-size: 24px;
            margin: 0;
        }

        /* ãƒãƒƒãƒ—ã‚¨ãƒªã‚¢ */
        .map-scroll-wrapper {
            overflow-x: auto;
            padding: 40px 20px;
            -webkit-overflow-scrolling: touch;
        }

        .map-path {
            display: flex;
            align-items: center;
            min-width: 1400px;
            padding: 40px;
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¸ãƒãƒ¼ãƒ‰ */
        .stage-wrapper {
            display: flex;
            align-items: center;
        }

        .stage-node {
            position: relative;
            width: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .stage-node:hover {
            transform: scale(1.1);
        }

        .stage-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 2;
            font-size: 40px;
        }

        .stage-node.completed .stage-icon {
            background: var(--accent-green);
            box-shadow: 0 0 20px rgba(142, 227, 143, 0.5);
        }

        .stage-node.current .stage-icon {
            background: var(--primary-blue);
            box-shadow: 0 0 30px rgba(77, 182, 247, 0.6);
            animation: pulse 2s infinite;
        }

        .stage-node.locked .stage-icon {
            background: var(--disabled-gray);
            opacity: 0.6;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 20px rgba(77, 182, 247, 0.6); }
            50% { box-shadow: 0 0 40px rgba(77, 182, 247, 0.8); }
            100% { box-shadow: 0 0 20px rgba(77, 182, 247, 0.6); }
        }

        .stage-number {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: 900;
            color: white;
        }

        .stage-node.locked .stage-number {
            color: #9CA3AF;
        }

        .stage-name {
            margin-top: 8px;
            font-size: 14px;
            font-weight: 700;
            text-align: center;
        }

        .current-marker {
            position: absolute;
            top: -20px;
            background: var(--primary-blue);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* ãƒ‘ã‚¹ãƒ©ã‚¤ãƒ³ */
        .path-line {
            width: 100px;
            height: 4px;
            background: #D1D5DB;
            z-index: 1;
            position: relative;
        }

        .path-line.completed {
            background: var(--accent-green);
        }

        .path-line.current {
            background: linear-gradient(90deg, var(--accent-green) 0%, #D1D5DB 100%);
        }

        /* ã‚¯ã‚¨ã‚¹ãƒˆé–‹å§‹ãƒœã‚¿ãƒ³ */
        .quest-start-btn {
            position: fixed;
            bottom: 40px;
            right: 40px;
            background: var(--cta-red);
            color: white;
            font-size: 20px;
            font-weight: 700;
            padding: 20px 40px;
            border-radius: 60px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 24px rgba(255, 107, 107, 0.4);
            animation: float 3s ease-in-out infinite;
            z-index: 100;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .quest-start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 32px rgba(255, 107, 107, 0.5);
        }

        .sword-icon {
            font-size: 24px;
        }

        /* ãƒ¢ãƒ¼ãƒ€ãƒ« */
        .stage-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .stage-modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.3s ease;
            position: relative;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 32px;
            height: 32px;
            border: none;
            background: #F3F4F6;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--cta-red);
            color: white;
        }

        .stage-title {
            font-size: 24px;
            margin-bottom: 16px;
        }

        .stage-description {
            color: var(--text-light);
            margin-bottom: 24px;
        }

        .clear-conditions {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .clear-conditions h3 {
            font-size: 16px;
            margin-bottom: 12px;
        }

        .clear-conditions ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .clear-conditions li {
            font-size: 14px;
            color: var(--text-light);
        }

        .progress-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .progress-bar {
            flex: 1;
            background: #E5E7EB;
            border-radius: 10px;
            height: 12px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-blue) 0%, #6DD5FF 100%);
            transition: width 0.5s ease;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .quest-start-btn {
                bottom: 20px;
                right: 20px;
                padding: 16px 24px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="map-header">
        <button class="home-btn">ğŸ </button>
        <h1 class="map-title heading-primary">ã‚¯ã‚¨ã‚¹ãƒˆãƒãƒƒãƒ—</h1>
    </header>

    <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼åè¡¨ç¤º -->
ã€€ã€€<div style="padding: 16px; font-size: 18px; font-weight: bold; text-align: center;">
   ã€€ <span id="usernameDisplay">ã‚ˆã†ã“ãå†’é™ºè€…ã•ã‚“ï¼</span>
ã€€ã€€</div>

    <!-- ãƒãƒƒãƒ—ã‚¨ãƒªã‚¢ -->
    <div class="map-scroll-wrapper">
        <div class="map-path">
            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸1 -->
            <div class="stage-wrapper">
                <div class="stage-node completed" onclick="openModal(1)">
                    <div class="stage-icon">
                        ğŸ˜ï¸
                        <span class="stage-number">1</span>
                    </div>
                    <div class="stage-name">ã¯ã˜ã¾ã‚Šã®æ‘</div>
                </div>
                <div class="path-line completed"></div>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸2 -->
            <div class="stage-wrapper">
                <div class="stage-node completed" onclick="openModal(2)">
                    <div class="stage-icon">
                        ğŸŒ³
                        <span class="stage-number">2</span>
                    </div>
                    <div class="stage-name">å†’é™ºã®æ£®</div>
                </div>
                <div class="path-line current"></div>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸3ï¼ˆç¾åœ¨åœ°ï¼‰ -->
            <div class="stage-wrapper">
                <div class="stage-node current" onclick="openModal(3)">
                    <div class="current-marker">ç¾åœ¨åœ°</div>
                    <div class="stage-icon">
                        â›°ï¸
                        <span class="stage-number">3</span>
                    </div>
                    <div class="stage-name">è©¦ç·´ã®å±±</div>
                </div>
                <div class="path-line"></div>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸4 -->
            <div class="stage-wrapper">
                <div class="stage-node locked" onclick="openModal(4)">
                    <div class="stage-icon">
                        ğŸŒŠ
                        <span class="stage-number">4</span>
                    </div>
                    <div class="stage-name">ç¥ç§˜ã®æ¹–</div>
                </div>
                <div class="path-line"></div>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸5 -->
            <div class="stage-wrapper">
                <div class="stage-node locked" onclick="openModal(5)">
                    <div class="stage-icon">
                        ğŸ°
                        <span class="stage-number">5</span>
                    </div>
                    <div class="stage-name">é­”ç‹ã®åŸ</div>
                </div>
                <div class="path-line"></div>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸6 -->
            <div class="stage-wrapper">
                <div class="stage-node locked" onclick="openModal(6)">
                    <div class="stage-icon">
                        ğŸŒŸ
                        <span class="stage-number">6</span>
                    </div>
                    <div class="stage-name">æ˜Ÿç©ºã®å¡”</div>
                </div>
                <div class="path-line"></div>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸7 -->
            <div class="stage-wrapper">
                <div class="stage-node locked" onclick="openModal(7)">
                    <div class="stage-icon">
                        ğŸœï¸
                        <span class="stage-number">7</span>
                    </div>
                    <div class="stage-name">ç ‚æ¼ ã®éºè·¡</div>
                </div>
                <div class="path-line"></div>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¸8 -->
            <div class="stage-wrapper">
                <div class="stage-node locked" onclick="openModal(8)">
                    <div class="stage-icon">
                        ğŸ”ï¸
                        <span class="stage-number">8</span>
                    </div>
                    <div class="stage-name">æ°·ã®æ´çªŸ</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ã‚¯ã‚¨ã‚¹ãƒˆé–‹å§‹ãƒœã‚¿ãƒ³ -->
    <button class="quest-start-btn">
        <span class="sword-icon">âš”ï¸</span>
        <span class="btn-text">ã‚¯ã‚¨ã‚¹ãƒˆã«æŒ‘ã‚€ï¼</span>
    </button>

    <!-- ã‚¹ãƒ†ãƒ¼ã‚¸è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="stage-modal" id="stageModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">Ã—</button>
            <h2 class="stage-title heading-secondary" id="modalTitle">ã‚¹ãƒ†ãƒ¼ã‚¸3: è©¦ç·´ã®å±±</h2>
            <p class="stage-description" id="modalDescription">
                å±±ã®é ‚ä¸Šã«ä½ã‚€è³¢è€…ã‹ã‚‰ã€è¨ˆç®—ã®æ¥µæ„ã‚’å­¦ã¼ã†ï¼
            </p>
            <div class="clear-conditions">
                <h3 class="heading-secondary">ã‚¯ãƒªã‚¢æ¡ä»¶</h3>
                <ul id="modalConditions">
                    <li>âœ“ æ›ã‘ç®—ã®å•é¡Œã‚’10å•æ­£è§£</li>
                    <li>âœ“ ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯ã§3åˆ†ä»¥å†…</li>
                    <li>â–¡ ãƒœãƒ¼ãƒŠã‚¹: ãƒãƒ¼ãƒŸã‚¹ã§ã‚¯ãƒªã‚¢</li>
                </ul>
            </div>
            <div class="progress-section">
                <span>é€²æ—</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="modalProgress" style="width: 30%"></div>
                </div>
                <span id="modalProgressText">30%</span>
            </div>
        </div>
    </div>

    <script>
        // ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿
        const stageData = {
            1: {
                title: "ã‚¹ãƒ†ãƒ¼ã‚¸1: ã¯ã˜ã¾ã‚Šã®æ‘",
                description: "å†’é™ºã®åŸºæœ¬ã‚’å­¦ã¼ã†ï¼æ‘ã®äººã€…ã‹ã‚‰ã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ã‚ˆã†ã€‚",
                conditions: [
                    "âœ“ è‡ªå·±ç´¹ä»‹ã‚’ã—ã‚ˆã†",
                    "âœ“ åˆã‚ã¦ã®ã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢",
                    "âœ“ ä»²é–“ã‚’1äººè¦‹ã¤ã‘ã‚‹"
                ],
                progress: 100
            },
            2: {
                title: "ã‚¹ãƒ†ãƒ¼ã‚¸2: å†’é™ºã®æ£®",
                description: "æ£®ã®ä¸­ã§ã€è¦³å¯ŸåŠ›ã¨æƒ³åƒåŠ›ã‚’é›ãˆã‚ˆã†ï¼",
                conditions: [
                    "âœ“ æ£®ã®ç”Ÿãç‰©ã‚’5ç¨®é¡è¦‹ã¤ã‘ã‚‹",
                    "âœ“ è¦³å¯Ÿæ—¥è¨˜ã‚’æ›¸ã",
                    "â–¡ ãƒœãƒ¼ãƒŠã‚¹: ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ç”Ÿãç‰©ã‚’æã"
                ],
                progress: 100
            },
            3: {
                title: "ã‚¹ãƒ†ãƒ¼ã‚¸3: è©¦ç·´ã®å±±",
                description: "å±±ã®é ‚ä¸Šã«ä½ã‚€è³¢è€…ã‹ã‚‰ã€è¨ˆç®—ã®æ¥µæ„ã‚’å­¦ã¼ã†ï¼",
                conditions: [
                    "âœ“ æ›ã‘ç®—ã®å•é¡Œã‚’10å•æ­£è§£",
                    "âœ“ ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯ã§3åˆ†ä»¥å†…",
                    "â–¡ ãƒœãƒ¼ãƒŠã‚¹: ãƒãƒ¼ãƒŸã‚¹ã§ã‚¯ãƒªã‚¢"
                ],
                progress: 30
            },
            4: {
                title: "ã‚¹ãƒ†ãƒ¼ã‚¸4: ç¥ç§˜ã®æ¹–",
                description: "æ¹–ã®ç²¾éœŠã‹ã‚‰ã€å”åŠ›ã®å¤§åˆ‡ã•ã‚’å­¦ã¼ã†ï¼",
                conditions: [
                    "â–¡ ãƒãƒ¼ãƒ ã§å”åŠ›ã—ã¦èª²é¡Œã‚’ã‚¯ãƒªã‚¢",
                    "â–¡ ä»–ã®äººã‚’åŠ©ã‘ã‚‹",
                    "â–¡ ãƒœãƒ¼ãƒŠã‚¹: ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®"
                ],
                progress: 0
            },
            5: {
                title: "ã‚¹ãƒ†ãƒ¼ã‚¸5: é­”ç‹ã®åŸ",
                description: "æœ€çµ‚æ±ºæˆ¦ï¼ä»Šã¾ã§å­¦ã‚“ã ã™ã¹ã¦ã‚’ä½¿ã£ã¦æŒ‘æˆ¦ã—ã‚ˆã†ï¼",
                conditions: [
                    "â–¡ ç·åˆãƒ†ã‚¹ãƒˆã«åˆæ ¼",
                    "â–¡ ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Œæˆ",
                    "â–¡ ãƒœãƒ¼ãƒŠã‚¹: å…¨å“¡ã§å”åŠ›ã—ã¦ã‚¯ãƒªã‚¢"
                ],
                progress: 0
            }
        };

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
        function openModal(stageNum) {
            const modal = document.getElementById('stageModal');
            const data = stageData[stageNum] || stageData[3];
            
            document.getElementById('modalTitle').textContent = data.title;
            document.getElementById('modalDescription').textContent = data.description;
            document.getElementById('modalConditions').innerHTML = data.conditions.map(c => `<li>${c}</li>`).join('');
            document.getElementById('modalProgress').style.width = data.progress + '%';
            document.getElementById('modalProgressText').textContent = data.progress + '%';
            
            modal.classList.add('active');
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeModal() {
            const modal = document.getElementById('stageModal');
            modal.classList.remove('active');
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å¤–å´ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰é–‰ã˜ã‚‹
        document.getElementById('stageModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

            // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹é–¢æ•°
    function getQueryParam(key) {
        const params = new URLSearchParams(window.location.search);
        return params.get(key);
    }

    // userãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦è¡¨ç¤º
    const user = getQueryParam('user');
    if (user) {
        document.getElementById('usernameDisplay').textContent = `ã“ã‚“ã«ã¡ã¯ã€${user}ã•ã‚“ï¼`;
    }
    </script>
</body>
</html>
